# 当前进度与待办

## 当前进度
- [x] 迭代零：完成后端/前端骨架搭建，提交 `58f4061`。
- [x] 后端引入 `air` 自动重载配置并新增请求日志（提交 `705789b`），默认监听端口修改为 `9180`。
- [x] 后端：新增分类 API 层 `httptest` 用例，覆盖创建/树查询/排序/回收站/恢复/彻底删除及常见异常流程，内存 fake NDR 支撑后续扩展。
- [x] 后端：目录树查询支持分页聚合，节点数量超出单页时依然返回完整树结构。
- [x] 后端：回收站列表分页聚合，确保大量软删除节点时依然完整返回并通过单元测试验证。
- [x] 后端：新增目录节点 `reposition` 接口，支持一次请求完成跨父节点移动与同级重排。
- [x] 后端：支持 `YDMS_DEBUG_TRAFFIC` 日志开关，输出 NDR 请求/响应辅助排查。
- [x] 后端：禁止删除包含子节点的目录，提供批量恢复/彻底删除结合的回收站操作。
- [x] 后端：`go run ./cmd/server --watch` 支持内置热重载，免去手动重启。
- [x] 后端：接入 NDR 文档接口（列表/创建/绑定），新增节点文档获取与绑定能力。

## 正在进行
- [ ] MVP 迭代一（目录管理）总体推进。
- [ ] 后端：实现目录节点的 CRUD、树查询、拖拽移动接口并对接 NDR。
  - [x] 扩展 NDR Client 支持节点增删改查、子节点查询等接口。
  - [x] 暴露 `/api/v1/categories` 系列接口（含 `tree`、`move`、`reorder`），完善请求头透传与错误处理。
  - [x] 编写拖拽移动/排序逻辑及相关单元测试，覆盖 reorder 场景。
  - [x] 清理依赖记录，执行 `go mod tidy`。
  - [x] 新增 NDR 客户端集成测试与目录操作日志，便于排查真实环境问题。
  - [x] 目录软删除：后端新增回收站接口、日志与操作记录，并支持永久删除；默认由中间件填充 `x-user-id`、`x-request-id`。
  - [x] 永久删除：通过 `YDMS_ADMIN_KEY` 自动补齐 `x-admin-key` 请求头，接入 NDR purge 接口。
  - [x] 启动时输出 NDR 配置摘要，辅助排查 `.env` 是否生效。
- [ ] 前端：完成目录树展示、节点 CRUD 表单、拖拽交互与接口联调。
  - [x] 接入目录树查询，基于 Antd Tree 展示结构并完成拖拽排序写回。
  - [x] 支持目录的新增、重命名、删除操作与详情面板，联动后端接口。
  - [x] 优化表单校验、操作状态反馈，并新增目录树搜索/展开能力。
  - [x] 拖拽排序改用 `reposition` 接口，避免二次请求及 NDR 404，新增前端校验与 `VITE_DEBUG_DRAG` 调试日志。
  - [x] 回收站批量恢复/彻底删除操作上线；目录树支持同父节点多选、高亮显示并校验跨层选择。
  - [ ] 右键菜单：实现复制 / 剪切 / 粘贴等批量操作。
  - [x] 软删除可视化：回收站视图、已删节点标记、恢复与彻底删除操作。
  - [x] 目录操作按钮图标化，回收站改为弹窗入口以释放主视图空间。
  - [x] 目录节点右键新增文档、文档区支持搜索与子树/当前节点切换。
  - [ ] 进一步优化：目录批量操作、彻底删除前的关联校验与提示。
- [ ] 文档维护：开发过程中同步更新项目规划与进度文档。

## 待办事项
- [ ] 整理 NDR 接口调用示例与错误约定，完善后端集成说明。
- [ ] 设计节点排序字段使用方案（`metadata.order`）并在实现前确认。
- [ ] 准备基础自动化测试方案（Go `httptest` + 前端组件测试）供后续落地。
  - [x] 后端分类 API `httptest` 覆盖主要操作与异常请求校验（含恢复、彻底删除），内存 fake NDR 提供可扩展测试基座。
  - [ ] 继续补齐更多 API 边界用例及前端组件测试。
*** End Patch
